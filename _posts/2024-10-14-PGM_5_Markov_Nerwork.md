## 1 Intro

![image-20241014100722122](./2024-10-14-PGM_5_Markov_Nerwork.assets/image-20241014100722122.png)
å·¦å›¾çš„ç‹¬ç«‹æ€§ï¼Œåœ¨å³è¾¹çš„ç‹¬ç«‹æ€§æ˜¯ä¸èƒ½å®Œå…¨é˜é‡Šçš„â€”â€”æˆ–è€…è¯´åœ¨ä»æ— å‘å˜æˆæœ‰å‘çš„æ—¶å€™ï¼ŒèŠ‚ç‚¹ä¹‹é—´çš„ç‹¬ç«‹æ€§å‘ç”Ÿäº†è½¬åŒ–

åœ¨å·¦å›¾ä¸­æ˜¯æœ‰indï¼ˆA,D|B,C)å’Œindï¼ˆB,C|A,D)

## 2 Markov Networks

å¯¹äºä¸Šè¿°çš„æƒ…æ™¯ï¼ŒèŠ‚ç‚¹ä¹‹é—´çš„ç›¸äº’ä½œç”¨æ˜¯æ²¡æœ‰æ–¹å‘çš„ï¼Œæ‰€ä»¥åº”è¯¥ç”¨æ— å‘å›¾ï¼ˆä¹Ÿç§°ä¸ºé©¬å°”å¯å¤«ç½‘ç»œï¼‰æ¥å»ºæ¨¡
åœ¨æ— å‘å›¾ä¸­ï¼ŒèŠ‚ç‚¹ä»£è¡¨éšæœºå˜é‡ï¼Œå¦‚æœä¸¤ä¸ªèŠ‚ç‚¹æ²¡æœ‰è·¯å¾„æ‰è¯´æ˜è¿™ä¸¤ä¸ªèŠ‚ç‚¹æ˜¯ç‹¬ç«‹çš„
![image-20241014101500415](./2024-10-14-PGM_5_Markov_Nerwork.assets/image-20241014101500415.png)

åœ¨ä¸Šè¿°è¿™ä¸ªå›¾ä¸­ï¼Œç»™å®šBç›¸å½“ä¸åœ¨BDä¹‹é—´çš„è·¯å¾„æ–©æ–­ï¼ŒDå°±å’ŒAä¸Cæ²¡æœ‰ä»»ä½•è·¯å¾„è”é€šäº†ï¼Œä¹Ÿå°±æ˜¯æ­¤æ—¶Dä¸Aå’ŒCç‹¬ç«‹
Markovæ€§å°±æ˜¯ç»™å®šé¢†åŸŸä¹‹åå°±å’Œå…¶ä»–èŠ‚ç‚¹æ²¡æœ‰å…³ç³»äº†ï¼Œç”±äºä¸Šè¿°çš„ç½‘ç»œå…·å¤‡è¿™ä¸ªæ€§è´¨ï¼Œæ‰€ä»¥ç§°ä¹‹ä¸º**Markov Networks**ï¼ˆåœ¨ç‰©ç†é‡Œåˆ™ç§°ä¹‹ä¸º**Markov random field**ï¼‰
æ— å‘å›¾çš„ç‰¹æ®Šç»“æ„å°±æ˜¯å¤šè¾¹å½¢ï¼ˆå¤§äºä¸‰ä¸ªèŠ‚ç‚¹ï¼‰ï¼Œè´å¶æ–¯ç½‘ç»œçš„ç‰¹æ®Šç»“æ„åˆ™æ˜¯V-structure

å¯¹äºæ— å‘å›¾è¿™ç±»ç›¸äº’ä½œç”¨çš„å»ºæ¨¡æ¥è¯´ï¼Œéœ€è¦ç»™å‡ºçš„çŠ¶æ€ä¹‹é—´çš„ç›¸äº’ä½œç”¨ï¼Œä¸è¦æ±‚åƒè´å¶æ–¯ç½‘ç»œä¸€æ ·å’Œä¸º1ç»™å‡ºæ¦‚ç‡çš„å½¢å¼

Gibbs åˆ†å¸ƒï¼šç”¨äºæè¿°ä¸Šè¿°çš„local factorsï¼ˆæœ€å¼€å§‹æºè‡ªäºä¸Šè¿°æè¿°åˆ†å­çŠ¶æ€çš„é—®é¢˜ï¼‰â€”â€”éœ€è¦å®šä¹‰åœ¨cliqueä¸Š
![image-20241014102614627](./2024-10-14-PGM_5_Markov_Nerwork.assets/image-20241014102614627.png)

è¿™é‡Œçš„$\pi[a,b]$å°±æ˜¯ABè¿™ç»„factorä¹‹é—´çš„ç›¸äº’å½±å“æƒ…å†µã€‚
åœ¨æ±‚å‡ºFä¹‹åéœ€è¦è¿›è¡Œå½’ä¸€åŒ–
P(a,b,c,d)å°±æ˜¯ç”¨äºæè¿°è¿™ä¸ªabcdç³»ç»Ÿåœ¨ç»™å®šåœºé‡Œçš„ç‰©ç†çŠ¶æ€

å›¾çš„åŸºæœ¬ç»“æ„å°±æ˜¯cliquesï¼Œè¦å…¨è”é€šçš„

> åœ¨é©¬å°”å¯å¤«ç½‘ç»œï¼ˆMarkov Networkï¼‰ä¸­ï¼ŒåŸºæœ¬å•å…ƒç§°ä¸ºå›¢ï¼ˆcliquesï¼‰ã€‚è¿™æ˜¯æŒ‡å›¾ä¸­ä»»æ„ä¸¤ä¸ªèŠ‚ç‚¹éƒ½ç›´æ¥è¿æ¥çš„æœ€å¤§å®Œå…¨å­å›¾ã€‚å…·ä½“æ¥è¯´ï¼š
> 1. **å›¢çš„å®šä¹‰**ï¼š
    - ä¸€ä¸ªå›¢æ˜¯ä¸€ä¸ªå­å›¾ï¼Œå…¶ä¸­æ¯å¯¹èŠ‚ç‚¹ä¹‹é—´éƒ½æœ‰è¾¹è¿æ¥ã€‚
    - æœ€å¤§å›¢æ˜¯å›¾ä¸­ä¸èƒ½å†æ‰©å±•çš„å®Œå…¨å­å›¾ã€‚
 2. **é©¬å°”å¯å¤«ç½‘ç»œä¸­çš„è§’è‰²**ï¼š
    
    - å›¢ç”¨äºå®šä¹‰è”åˆæ¦‚ç‡åˆ†å¸ƒã€‚
    - æ¯ä¸ªå›¢å…³è”ä¸€ä¸ªåŠ¿å‡½æ•°ï¼Œç”¨äºè¡¨ç¤ºèŠ‚ç‚¹ä¹‹é—´çš„ç›¸äº’ä½œç”¨ã€‚
    - åŠ¿å‡½æ•°ä¸ç›´æ¥æ˜¯æ¦‚ç‡ï¼Œä½†ç”¨äºè®¡ç®—æ¦‚ç‡åˆ†å¸ƒã€‚
>å›¢åœ¨é©¬å°”å¯å¤«ç½‘ç»œä¸­ç”¨äºæ•æ‰å±€éƒ¨ä¾èµ–å…³ç³»ï¼Œå¸®åŠ©æ„å»ºè”åˆæ¦‚ç‡åˆ†å¸ƒã€‚

åœ¨æ— å‘å›¾é‡Œï¼Œæˆ‘ä»¬éœ€è¦å…³æ³¨æå¤§å®Œå…¨å­å›¾ï¼ˆmaximal cliquesï¼‰â€”â€”å¤šä¸ªå¤§å­å›¾
![image-20241014105924736](./2024-10-14-PGM_5_Markov_Nerwork.assets/image-20241014105924736.png)

ä¾‹å¦‚åœ¨ä¸Šè¿°çš„æ— å‘å›¾ä¸­ï¼Œæœ‰ä¸‰ä¸ªæå¤§å­å›¾åˆ†åˆ«æ˜¯è“è‰²ç»¿è‰²å’Œæ©˜è‰²çš„åœˆï¼Œæœ€å¤§å­å›¾æ˜¯è“è‰²åœˆ
åœ¨è¿›è¡Œå› å­åˆ†è§£çš„æ—¶å€™éœ€è¦ç”¨é«˜é˜¶çš„å¤§å­å›¾è€Œä¸èƒ½å…¨ç”¨ä½é˜¶çš„å¦‚è¾¹å»æ„æˆfactors
![image-20241014110201360](./2024-10-14-PGM_5_Markov_Nerwork.assets/image-20241014110201360.png)
æ­£æ¨æ˜¯çœ‹å›¾è¯´è¯ï¼Œåæ¨æ˜¯ç»“æ„å­¦ä¹ 

ç»™å®šä¸€ä¸ªå›¾Hï¼Œå…¶ä¸­æœ‰è‹¥å¹²ä¸ªcliques D1,â€¦â€¦Dnï¼Œä¸”factorså®šä¹‰åœ¨cliquesä¸Šï¼š
![image-20241014110416834](./2024-10-14-PGM_5_Markov_Nerwork.assets/image-20241014110416834.png)
è¿™é‡Œçš„Zæ˜¯åˆ†å¸ƒå‡½æ•°ï¼ˆPartition function or so called total energy)
ä¾‹å¦‚å¯¹äºä¸‹è¿°çš„ç½‘ç»œï¼Œåªæœ‰ä¸¤ç§factorsï¼Œåˆ†åˆ«æ—¶ç‚¹å’Œè¾¹ï¼š
![image-20241014110554444](./2024-10-14-PGM_5_Markov_Nerwork.assets/image-20241014110554444.png)
$$
P=\frac{1}{Z}\ (\Pi_i \ \pi[X_i] )\ (\Pi_i \ \pi[X_i,X_j])
$$
ä¹˜ç§¯åœ¨æ±‚å¯¼çš„æ—¶å€™ä¸æ–¹ä¾¿ï¼Œæ‰€ä»¥å¾€å¾€ä¼šå˜æˆå–å¯¹æ•°çš„æ–¹å¼æ¥å®ç°ä¹˜ç§¯å˜æˆçº¿æ€§ï¼ˆéœ€è¦ç»“åˆç‰©ç†æƒ…æ™¯æ¥ç†è§£é‡Œé¢çš„è´Ÿå·ï¼‰
$$
ğœ‹[ğ‘«] = exp( âˆ’ğœ€[ğ‘«])\ where \ ğœ€[ğ‘«] = âˆ’ln[ğœ‹[ğ‘«]]
$$
é‚£ä¹ˆå¯ä»¥æŠŠè”åˆæ¦‚ç‡è½¬åŒ–ä¸ºï¼š
![image-20241014111137407](./2024-10-14-PGM_5_Markov_Nerwork.assets/image-20241014111137407.png)

åœ¨æ— å‘å›¾ä¸­å¾ˆå¤šæƒ…å†µä¸‹ä¸å…³å¿ƒç»å¯¹å€¼ï¼Œè€Œå…³å¿ƒç›¸å¯¹å€¼ï¼ˆè¿™æ˜¯å› ä¸ºåˆ†å¸ƒå‡½æ•°éœ€è¦å¯¹è¿™ä¹ˆå¤šå†…å®¹æ±‚å’Œï¼Œæ±‚å’Œæ˜¯å¾ˆéš¾æ±‚æ€»å’Œçš„ï¼Œæ‰€ä»¥æƒ³ç”¨å…¶ä»–çŠ¶æ€/åŸºæ€çš„æ–¹å¼æ¥æ¶ˆé™¤zçš„æ±‚å’Œå›°éš¾ï¼‰
![image-20241014111303311](./2024-10-14-PGM_5_Markov_Nerwork.assets/image-20241014111303311.png)
è¿™ä¸ªå®šç†ç»™å‡ºäº†Î çš„å½¢å¼ï¼ˆæ„é€ æ€§çš„è§£)
éœ€è¦æ»¡è¶³Hæ˜¯æ­£æ¦‚ç‡åˆ†å¸ƒçš„I-Map
![image-20241014111933452](./2024-10-14-PGM_5_Markov_Nerwork.assets/image-20241014111933452.png)
$$
Q=(Î±_a a+â€¦â€¦+\alpha_ff)+(\beta_{ab}ab+â€¦â€¦+\beta_{df}df)
+(\gamma_{cde}cde+\gamma_{abc}abc+â€¦â€¦+\gamma{bcd}bcd)
+\mu_{a,b,c,d}abcd
$$
æ­¤æ—¶$$P=1/z*exp(-Q)$$
![image-20241014113232454](./5. Markov Nerwork.assets/image-20241014113232454.png)
![image-20241014114135716](./5. Markov Nerwork.assets/image-20241014114135716.png)
è¿™é‡Œçš„Zï¼š
$$
Z=\sum_{A,B,C,D,E}exp(-U)
$$
(U=-Qï¼Œç”¨Uæ—¶ä¸ºäº†å’Œèƒ½é‡å‡½æ•°æ‰€åŒ¹é…)

## 3 Continuous Variables

å¤šå…ƒé«˜æ–¯åˆ†å¸ƒå¯ä»¥é€šè¿‡å¯¹åº”éšæœºå˜é‡çš„åæ–¹å·®ä¸º0æ¥ç›´æ¥å¾—åˆ°å…¶å®Œå…¨ç‹¬ç«‹
æ›´å¸¸è§çš„æƒ…å†µæ—¶åæ–¹å·®çŸ©é˜µä¸º0çš„åœ°æ–¹ï¼Œå½“ä¸”ä»…å½“xå’Œjä¹‹é—´æ²¡æœ‰ç›´æ¥çš„è¾¹â€”â€”ä¹Ÿå°±æ˜¯å¯ä»¥æ ¹æ®æ±‚è§£ä¿¡æ¯çŸ©é˜µä¸€ä¸‹å°±å¯ä»¥ç”»å‡ºé«˜æ–¯éšæœºåœºçš„æ‹“æ‰‘ç»“æ„
![image-20241014120448241](./2024-10-14-PGM_5_Markov_Nerwork.assets/image-20241014120448241.png)
![image-20241014120459828](./2024-10-14-PGM_5_Markov_Nerwork.assets/image-20241014120459828.png)

